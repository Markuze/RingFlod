%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Template for USENIX papers.
%
% History:
%
% - TEMPLATE for Usenix papers, specifically to meet requirements of
%   USENIX '05. originally a template for producing IEEE-format
%   articles using LaTeX. written by Matthew Ward, CS Department,
%   Worcester Polytechnic Institute. adapted by David Beazley for his
%   excellent SWIG paper in Proceedings, Tcl 96. turned into a
%   smartass generic template by De Clarke, with thanks to both the
%   above pioneers. Use at your own risk. Complaints to /dev/null.
%   Make it two column with no page numbering, default is 10 point.
%
% - Munged by Fred Douglis <douglis@research.att.com> 10/97 to
%   separate the .sty file from the LaTeX source template, so that
%   people can more easily include the .sty file into an existing
%   document. Also changed to more closely follow the style guidelines
%   as represented by the Word sample file.
%
% - Note that since 2010, USENIX does not require endnotes. If you
%   want foot of page notes, don't include the endnotes package in the
%   usepackage command, below.
% - This version uses the latex2e styles, not the very ancient 2.09
%   stuff.
%
% - Updated July 2018: Text block size changed from 6.5" to 7"
%
% - Updated Dec 2018 for ATC'19:
%
%   * Revised text to pass HotCRP's auto-formatting check, with
%     hotcrp.settings.submission_form.body_font_size=10pt, and
%     hotcrp.settings.submission_form.line_height=12pt
%
%   * Switched from \endnote-s to \footnote-s to match Usenix's policy.
%
%   * \section* => \begin{abstract} ... \end{abstract}
%
%   * Make template self-contained in terms of bibtex entires, to allow
%     this file to be compiled. (And changing refs style to 'plain'.)
%
%   * Make template self-contained in terms of figures, to
%     allow this file to be compiled. 
%
%   * Added packages for hyperref, embedding fonts, and improving
%     appearance.
%   
%   * Removed outdated text.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[letterpaper,twocolumn,10pt]{article}
\usepackage{usenix2019_v3}
%\usepackage[sorting=none]{biblatex}

% to be able to draw some self-contained figs
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{fancyvrb}
\usepackage{listings}
\usepackage{comment}
\usepackage{enumitem}
%striketrough
\usepackage[normalem]{ulem}
\usepackage{soul}

% inlined bib file
\usepackage{filecontents}

\providecommand{\data}{\textit{data}}
\providecommand{\shinfo}{\texttt{skb\_shared\_info}}
\providecommand{\skb}{\texttt{sk\_buff}}
\providecommand{\page}{\texttt{struct page}}
\providecommand{\uarg}{\texttt{ubuf\_info}}
\providecommand{\kva}{KVA}
\providecommand{\iova}{IOVA}
\providecommand{\mabaf}{malicious buffer}
\providecommand{\spb}{SPB\-2}
\providecommand{\oportunity}{\textit{Opportunity}}
\providecommand{\means}{\textit{Means}}
\providecommand{\motivation}{\textit{Motive}}
\providecommand{\simple}{\textit{single-step}}
\providecommand{\compound}{\textit{compound}}
\providecommand{\subpage}{sub-page}

\newcommand{\SV}[1]{{\textcolor{red}{[Shay:#1}]}} 

%-------------------------------------------------------------------------------
\begin{document}
%-------------------------------------------------------------------------------

%don't want date printed
\date{}

% make title bold and 14 pt font (Latex default is non-bold, 16 pt)
\title{\Large \bf Motive, Means \& Opportunity: The Anatomy of DMA Attacks}

% USENIX Security has double blind submissions
\begin{comment}
\author{
{\rm Markuze Alex}\\
Technion, VMware Research
\and
{\rm Shay Vargaftik}\\
VMware Research
\and
{\rm Gil Kupfer}\\
Technion
% copy the following lines to add more authors
\and
{\rm Nadav Amit}\\
VMware Research
\and{\rm Dan Tsafrir}\\
Technion, VMware Research
} % end author
\end{comment}

\maketitle

%-------------------------------------------------------------------------------
\begin{abstract}
%-------------------------------------------------------------------------------
%\textcolor{red}{Before: chaos Now Oder == MMO, taxonomy of DMA vulnerabilities Result \compound attacks. + tool. We expose  a deep-rooted issue in OS design rather than ad-hoc buggies... The language:\simple vs. \compound, MMO, \subpage types.}


Direct Memory Access (DMA) makes the system vulnerable to DMA attacks, where IO devices, can access memory regions not intended for their use. Recent findings have shown that IOMMU is unable to provide adequate protection against DMA attacks, leaving the system unprotected from multiple exploits. However, previously reported vulnerabilities have an ad-hoc nature rather than a structured top-down approach. Such cases create a dangerous misconception; that buggy device drivers or poor but isolated design choices are to blame for DMA vulnerabilities. 

We demonstrate that, in fact, it is often the Kernel itself that supplements the missing pieces needed for the attack, revealing that DMA vulnerability is deeply rooted in OS design rather than a collection of disjoint incidents. 

Accordingly, we introduce Motive, Means $\&$ Opportunity (MMO), a trifecta of attributes for identifying viable DMA attacks and develop an MMO inspired static code analysis tool capable of identifying device drivers at a high level of risk to DMA attack. We contend that previous attacks and vulnerabilities fall into a category we term \simple{} attacks, cases where the trifecta is present in a single page. We then present \compound{} attacks; situations, where the trifecta is initially incomplete but can be collected by carefully exploiting standard OS behavior. Finally, in our attacks, we focus on code injection attacks targeting the Linux kernel. We demonstrate both previously unreported \simple{} attacks and continue to the more complex \compound{} attacks.

\begin{comment}


\smallskip
TODO:

\begin{enumerate}
    \item \st{Introduce Compound DMA attacks vs. straightforward -- add in intro and contribution list.}
    \item \st{Connect type (c) opportunity gaining vulnerability is not connected to paper...
    add examples.}
    \item Conclusions: add communication with Linux
    \item Go over ndss references and copy everything relevant to our related work.
    \item Check and then update all access dates in ferences links.
    \item Check: Section -> Sec. , Figure-> Fig. ... ect.
    \item check smallskip consistency.
    \item \st{change bnx2 to tg3 (NetXtreme BCM5720)- (napi\_alloc\_frag - type (c))}
\end{enumerate}
\end{comment}

\end{abstract}
%-------------------------------------------------------------------------------
\input{intro.tex}


%-------------------------------------------------------------------------------
 
\input{background.tex}
\input{os_defences.tex}
\input{attack_mechanics.tex}
\input{attack_setup.tex}
\input{linux_net.tex}
\input{related_work.tex}
\input{conclusion.tex}


\bibliographystyle{plain}
\bibliography{references}
\appendix

\input{appendixes/shellcode.tex}
%\input{appendixes/dma_bidir.tex}
%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
