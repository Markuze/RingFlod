\documentclass[sigplan,review,anonymous]{acmart}
\acmSubmissionID{336}
\renewcommand\footnotetextcopyrightpermission[1]{}
\settopmatter{printacmref=false}
%\documentclass[letterpaper,twocolumn,10pt]{article}
%\usepackage{usenix2019_v3}
%\pagestyle{plain}


\usepackage{color}
\usepackage{xspace}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage[english]{babel}
\usepackage{textcomp}
\usepackage{times}
\usepackage{amsmath}
\usepackage{setspace}
\usepackage[inline]{enumitem}
\usepackage{natbib}
\usepackage{graphicx}
\usepackage[normalem]{ulem}
\usepackage{soul}
\usepackage{latexsym}
\usepackage{bbding}
\usepackage{pbox}
% to be able to draw some self-contained figs
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{fancyvrb}
\usepackage{listings}
\usepackage{adjustbox}
\usepackage{comment}
\usepackage{enumitem}
%striketrough
\usepackage[normalem]{ulem}
\usepackage{soul}
\usepackage{xspace}
\usepackage{enumitem,kantlipsum}

\usepackage{xcolor}
\usepackage{adjustbox}
\usepackage{graphicx}
%\usepackage[table,xcdraw]{xcolor}

% inlined bib file
\usepackage{filecontents}

% break long urls
\usepackage{url}
\makeatletter
\g@addto@macro{\UrlBreaks}{\UrlOrds}
\makeatother


\providecommand{\data}{\textit{data}\xspace}
\providecommand{\shinfo}{\texttt{skb\_shared\_info}\xspace}
\providecommand{\skb}{\texttt{sk\_buff}\xspace}
\providecommand{\page}{\texttt{struct page}\xspace}
\providecommand{\uarg}{\texttt{ubuf\_info}\xspace}
\providecommand{\kva}{KVA\xspace}
\providecommand{\iova}{IOVA\xspace}
\providecommand{\mabaf}{malicious buffer\xspace}
\providecommand{\spb}{SPB\-2\xspace}
\providecommand{\oportunity}{\textcolor{red}{Opportunity}\xspace}
\providecommand{\means}{\textcolor{red}{Means}\xspace}
\providecommand{\motivation}{\textcolor{red}{Motive}\xspace}
%\providecommand{\motivation}{\textit{Ma\-buff}\xspace}
\providecommand{\simple}{\textit{single-step}\xspace}
\providecommand{\Simple}{\textit{Single-step}\xspace}
\providecommand{\compound}{\textit{compound}\xspace}
\providecommand{\Compound}{\textit{Compound}\xspace}
\providecommand{\subpage}{sub-page\xspace}
%\providecommand{\tool}{SCAT\xspace}
\providecommand{\tool}{SPADE\xspace}
\providecommand{\dkasan}{D-KASAN\xspace}
\providecommand{\version}{5.0\xspace}
\providecommand{\latestversion}{5.6\xspace}

\newcommand{\SV}[1]{{\textcolor{red}{[Alex\&Shay:#1}]}} 
\newcommand{\adam}[1]{{\footnotesize\color{blue}[Adam: #1]}}

\newcommand{\X}{\textcolor{red}{\XSolidBrush}}
\newcommand{\V}{\textcolor{green}{\Checkmark}}
%BUFFER & ADDRESS & ACCESS
%-------------------------------------------------------------------------------
\begin{document}
%-------------------------------------------------------------------------------


%don't want date printed
%\date{}

% make title bold and 14 pt font (Latex default is non-bold, 16 pt)
%\title{\Large \bf Motive, Means \& Opportunity: The Anatomy of DMA Attacks}
%\title{\Large \bf The Anatomy of IOMMU subverting DMA Attacks}

\title{\Large \bf  Understanding DMA Attacks in the Presence of an IOMMU}
%\title{\Large \bf Endemic Weakness in DMA I/O: The Anatomy of DMA Attacks}
%\title{\Large \bf Systematizing DMA Vulnerabilities}
%\title{\Large \bf Endemic Weakness in DMA I/O: Systematizing DMA Vulnerabilities}

% % USENIX Security has double blind submissions
% \begin{comment}
% \author{
% {\rm Markuze Alex}\\
% Technion, VMware Research
% \and
% {\rm Shay Vargaftik}\\
% VMware Research
% \and
% {\rm Gil Kupfer}\\
% Technion
% % copy the following lines to add more authors
% \and
% {\rm Nadav Amit}\\
% VMware Research
% \and{\rm Dan Tsafrir}\\
% Technion, VMware Research
% } % end author
% \end{comment}

%\maketitle
%-------------------------------------------------------------------------------
\begin{abstract}
%-------------------------------------------------------------------------------
%\textcolor{red}{Before: chaos Now Oder == MMO, taxonomy of DMA vulnerabilities Result \compound attacks. + tool. We expose  a deep-rooted issue in OS design rather than ad-hoc buggies... The language:\simple vs. \compound, MMO, \subpage types.}


Direct Memory Access (DMA) makes the system vulnerable to DMA attacks, in which I/O devices access memory regions not intended for their use. Hardware IOMMU protection is unable to prevent all DMA attacks because it restricts DMA at page-level granularity leading to \subpage vulnerabilities. Conventional wisdom is that \subpage vulnerabilities that lead to viable DMA attacks are made possible by buggy device drivers or poor (but isolated) driver design choices.

This paper disproves the above belief, showing that it is often the kernel design that enables a DMA attack. To this end, we first categorize the four types of sub-page vulnerability, providing insight into the structure of DMA vulnerabilities. Then, to exploit these vulnerabilities, we present a schema for identifying viable attack vectors by malicious DMA capable devices. Specifically, we identify a trifecta of vulnerability attributes which is sufficient to layout code injection attacks. 

We then build analysis tools that detect potentially hazardous sub-page vulnerabilities and analyze the Linux kernel. We find that 12\% of the device drivers expose sensitive callback pointers, and as much as 60\% of device drivers are vulnerable to DMA attacks due to OS design choices. 

Aided by the output of the tools, we demonstrate novel code injection attacks on the Linux kernel.
Specifically, while all previously reported attacks are \emph{single-step}, i.e., with the vulnerability trifecta present in a single page, 
we present a new type of \compound{} attacks where the trifecta of vulnerability attributes is initially incomplete but can be attained by carefully exploiting standard OS behavior. 

\end{abstract}
\maketitle

%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------

\input{intro}
\input{background}
\input{os_defences}
\input{attack_mechanics}
\input{tool}
\input{dma_kasan}
\input{setup}
\input{linux_net}
\input{other_os}
\input{related_work}
\input{conclusion}

\bibliographystyle{plain}
\bibliography{references}
\appendix

%\input{appendixes/shellcode}
%\input{appendixes/dma_bidir.tex}
%\input{appendixes/more_attacks}
%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
