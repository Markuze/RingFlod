%\documentclass[sigconf]{acmart}
%\documentclass[twocolumn]{IEEEtran}
%\documentstyle[9pt,twocolumn,technote,twoside]{IEEEtran}
%\settopmatter{printacmref=false}
%\setcopyright{none}
%\renewcommand\footnotetextcopyrightpermission[1]{}
\documentclass[letterpaper,twocolumn,10pt]{article}
\usepackage{usenix2019_v3}
\pagestyle{plain}

%\acmConference[CCS '20]{CCS '20: The ACM Conference on Computer and Communications Security (CCS)}{November 09--13, 2020}{Orlando, USA}

% to be able to draw some self-contained figs
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{fancyvrb}
\usepackage{listings}
\usepackage{adjustbox}
\usepackage{comment}
\usepackage{enumitem}
%striketrough
\usepackage[normalem]{ulem}
\usepackage{soul}
\usepackage{xspace}
\usepackage{enumitem,kantlipsum}

\usepackage{xcolor}

\usepackage{graphicx}
%\usepackage[table,xcdraw]{xcolor}

% inlined bib file
\usepackage{filecontents}

% break long urls
\usepackage{url}
\makeatletter
\g@addto@macro{\UrlBreaks}{\UrlOrds}
\makeatother


\providecommand{\data}{\textit{data}\xspace}
\providecommand{\shinfo}{\texttt{skb\_shared\_info}\xspace}
\providecommand{\skb}{\texttt{sk\_buff}\xspace}
\providecommand{\page}{\texttt{struct page}\xspace}
\providecommand{\uarg}{\texttt{ubuf\_info}\xspace}
\providecommand{\kva}{KVA\xspace}
\providecommand{\iova}{IOVA\xspace}
\providecommand{\mabaf}{malicious buffer\xspace}
\providecommand{\spb}{SPB\-2\xspace}
\providecommand{\oportunity}{\textit{Opportunity}\xspace}
\providecommand{\means}{\textit{Means}\xspace}
\providecommand{\motivation}{\textit{Motive}\xspace}
%\providecommand{\motivation}{\textit{Ma\-buff}\xspace}
\providecommand{\simple}{\textit{single-step}\xspace}
\providecommand{\Simple}{\textit{Single-step}\xspace}
\providecommand{\compound}{\textit{compound}\xspace}
\providecommand{\Compound}{\textit{Compound}\xspace}
\providecommand{\subpage}{sub-page\xspace}
\providecommand{\tool}{SCAT\xspace}
\providecommand{\dkasan}{D-KASAN\xspace}
\newcommand{\SV}[1]{{\textcolor{red}{[Shay:#1}]}} 

\newcommand{\adam}[1]{{\footnotesize\color{blue}[Adam: #1]}}

%BUFFER & ADDRESS & ACCESS
%-------------------------------------------------------------------------------
\begin{document}
%-------------------------------------------------------------------------------


%don't want date printed
%\date{}

% make title bold and 14 pt font (Latex default is non-bold, 16 pt)
\title{\Large \bf Motive, Means \& Opportunity: The Anatomy of DMA Attacks}
%\title{\Large \bf Buffer, Address \& Access: The Anatomy of DMA Attacks}

% % USENIX Security has double blind submissions
% \begin{comment}
% \author{
% {\rm Markuze Alex}\\
% Technion, VMware Research
% \and
% {\rm Shay Vargaftik}\\
% VMware Research
% \and
% {\rm Gil Kupfer}\\
% Technion
% % copy the following lines to add more authors
% \and
% {\rm Nadav Amit}\\
% VMware Research
% \and{\rm Dan Tsafrir}\\
% Technion, VMware Research
% } % end author
% \end{comment}

\maketitle
%-------------------------------------------------------------------------------
\begin{abstract}
%-------------------------------------------------------------------------------
%\textcolor{red}{Before: chaos Now Oder == MMO, taxonomy of DMA vulnerabilities Result \compound attacks. + tool. We expose  a deep-rooted issue in OS design rather than ad-hoc buggies... The language:\simple vs. \compound, MMO, \subpage types.}
\SV{MMO is necessary and sufficient for code injection - also with only a part of MMO can do a lot of damage}
Direct Memory Access (DMA) makes the system vulnerable to DMA attacks, in which I/O devices access memory regions not intended for their use. Hardware IOMMU protection is unable to prevent all DMA attacks, because it restricts DMA at page-level granularity, whereas DMA buffers can reside on the same page as other data. Conventional wisdom is that DMA attacks are made possible by buggy device drivers or poor (but isolated) driver design choices.
This paper disproves the above belief, showing that it is often the kernel design that enables a DMA attack. To this end, we introduce Motive, Means $\&$ Opportunity (MMO), a trifecta of attributes that characterize any DMA vulnerability. We then further develop an MMO-inspired static code analysis tool identifying device drivers susceptible to DMA attacks. Using this tool we analize the Linux kernel and we find that 12\% of the device drivers expose sensitive callback pointers, and as much as 50\% of device drivers are vulnerable to DMA attacks due to OS design choices. 
%
Since static analysis may not reveal opportunities for random access attacks, we further develop a run-time analysis tool to identify inadvertently exposed memory allocations.
Utilizing the MMO schema, we find that previously reported DMA attacks fall into a category we term \simple{} attacks, cases where the trifecta of vulnerability attributes is present in a single memory page. We then continue to present a new type of more complex DMA attacks we term \compound{} attacks. Namely, situations where \simple{} attacks are not viable since the trifecta of vulnerability attributes is initially incomplete. Nevertheless, as we show, the missing trifecta attributes they can be produced by carefully exploiting standard OS behavior. We focus on code injection attacks targeting the Linux kernel and, demonstrate both previously unreported \simple{} attacks and new, more complex, \compound{} attacks.



%\textcolor{red}{TODO: 
%\begin{enumerate}
%    \item New Section 5. on tool design + figure.
%    \begin{enumerate}
%        \item Tool stats - Table.
%        \item Tool limitations: False positive/negative stats + example.
%        \item FreeBSD?.
%        \item Add type C vulnerability finder - cscope.
%    \end{enumerate}
%    \item Tool output on spb2.
%    \item mention tool github.
%    \item \st{change layout to css.}\\ \url{https://www.sigsac.org/ccs/CCS2020/call-for-papers.html}
%\end{enumerate}
%}


% \begin{comment}
% \smallskip
% TODO:

% \begin{enumerate}
%     \item \st{Introduce Compound DMA attacks vs. straightforward -- add in intro and contribution list.}
%     \item \st{Connect type (c) opportunity gaining vulnerability is not connected to paper...
%     add examples.}
%     \item \st{Conclusions: add communication with Linux}
%     \item \st{Go over ndss references and copy everything relevant to our related work.}
%     \item Mention smep/smap in either sec. 6 or related...
%     \item \st{Check and then update all access dates in ferences links.}
%     \item \st{Check: Section -> Sec. , Figure-> Fig. ... ect.}
%     \item \st{check smallskip consistency.}
%     \item \st{change bnx2 to tg3 (NetXtreme BCM5720)- (napi\_alloc\_frag - type (c))}
% \end{enumerate}
% \end{comment}

\end{abstract}

%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------

\input{intro}
\input{background}
\input{os_defences}
\input{attack_mechanics}
\input{tool}
\input{dma_kasan}
\input{attack_setup}
\input{linux_net}
\input{related_work}
\input{conclusion}

\bibliographystyle{plain}
\bibliography{references}
\appendix

\input{appendixes/shellcode}
%\input{appendixes/dma_bidir.tex}
\input{appendixes/more_attacks}
%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
