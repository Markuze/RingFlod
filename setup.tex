\section{Attack setup}
In our attacks, we use a 28 core, Dell PowerEdge R730 server, with Ubuntu 18.04 (kernel version 5.0), as our victim machine. This server is equipped with Intel VT-d IOMMU, a Broadcom NetXtreme BCM5720 Gigabit Ethernet NIC, a Mellanox Technologies ConnectX-4 Ethernet NIC and VIA Technologies, Inc. VT6315 Series Firewire Controller. An identical machine connected to the victim via a FireWire cable acting as the attacker. 

We create a malicious FireWire device by modifying the Linux-IO Target (LIO) subsystem on the attacker machine. The LIO subsystem supports hard disk emulation for remote computers via the \spb{} protocol. As such, it is a suitable platform to execute such attacks. 

We implement and demonstrate various attacks against the Linux kernel network stack. In order to demonstrate an attack by a malicious NIC, we use a FireWire device similarly to \cite{SLND10}. To emulate an attack by a malicious NIC using a FireWire device, we create an \iova{} page table sharing between the FireWire and the actual NIC. A minor patch is needed for the victim OS to facilitate this emulation. This way, the attacker machine can access the same pages as the NIC. This allows us to execute an attack using a programmable interface, emulating a malicious NIC. This minor patch was only done to emulate a device, so that we did not have to implement NIC firmware. The core OS was unchanged.

Due to space limitations we demonstrate selected Compound DMA attacks in Section Sec. \ref{sec:linux_net}. Upon the publication of our work we aim at releasing extended material including evaluation scripts as well as additional \compound and previously unknown \simple attacks found by our tools.